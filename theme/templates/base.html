<!DOCTYPE html>
<html lang="{{ DEFAULT_LANG }}">
<head>
    {% block head %}
        <title>{% block title %}{{ SITENAME }}{% endblock %}</title>
        <meta charset="utf-8" />
        <meta name="author" content="Peter Naudus (LinuxLefty)" />
        <link href="{{ SITEURL }}/theme/css/reset.css" rel="stylesheet" type="text/css" media="screen"/>
        <link href="{{ SITEURL }}/theme/css/taf-seafarer-l.css" rel="stylesheet" type="text/css" media="screen"/>
        <link href="{{ SITEURL }}/theme/css/template.css" rel="stylesheet" type="text/css" media="screen"/>
        <link href="{{ SITEURL }}/theme/css/categories.css" rel="stylesheet" type="text/css" media="screen"/>
        <link href="{{ SITEURL }}/theme/css/fonts/stylesheet.css" rel='stylesheet' type='text/css'>
        <link href="{{ SITEURL }}/theme/css/pygments.css" rel='stylesheet' type='text/css'>
        <link href="{{ SITEURL }}/theme/css/cikonss.css" rel='stylesheet' type='text/css'>
        <link href="{{ SITEURL }}/{{ FEED }}" type="application/atom+xml" rel="alternate" title="{{ SITENAME }} ATOM Feed" />
        {% if FEED_RSS -%}
        <link href="{{ SITEURL }}/{{ FEED_RSS }}" type="application/rss+xml" rel="alternate" title="{{ SITENAME }} RSS Feed" />
        {%- endif %}
        <!--[if IE]><script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
    {% endblock head %}
</head>

<body class="{% block body_class %}article-list{% endblock %}">
    <div id="page">
        <header>
        <a href="{{ SITEURL }}" id="logo">
            <img height=100px width=314px src="{{ SITEURL }}/theme/img/logo1.gif" class="first">
            <img height=100px width=314px src="{{ SITEURL }}/theme/img/logo1.gif" class="second">
        </a>
            <nav><ul>
                <li class="home inactive">
                    <span><a href="{{ SITEURL }}">&nbsp;Home&nbsp;</a></span>
                </li>
                {%- if MENUITEMS -%}
                    {% for title, link in MENUITEMS.sort() -%}
                        <li><a href="{{ link }}">{{ title }}</a></li>
                    {%- endfor %}
                {%- endif -%}
                {%- if DISPLAY_PAGES_ON_MENU -%}
                    {% for p in PAGES -%}
                        <li {% if p == page %}class="active"{% endif %}>
                            <a href="{{ SITEURL }}/{{ p.url }}">{{ p.title }}</a>
                        </li>
                    {%- endfor %}
                {%- endif %}
                {% for cat, null in categories -%}
                <li class="{% if cat == category %}active{% else %}inactive{% endif %} {{ cat }}">
                        <a href="{{ SITEURL }}/{{cat.slug}}/index.html">&nbsp;{{ cat.name.replace('_', ' ') }}&nbsp;</a>
                    </li>
                {%- endfor %}
            </ul></nav>
        </header>

        <div id="main">
            <div id="main_inner">
                <form method="get" action="http://duckduckgo.com" id="search">
                <input size="15" name="q">
                <input type="hidden" name="sites" value="linuxlefty.com">
                <input type="submit" value="Search">
                </form>
                <div id="content_wrapper">
                    <div id="banner"><h1> {% block banner %} {% endblock %} </h1></div>
                        {% block content %} {% endblock %}
                        <div id="scroll_msg"></div>
                    <div class="clear"></div>
                </div>
            </div>
        </div>

        <footer>
            {% block footer %} {% endblock %}
            <a rel="nofollow" target="_blank" href="http://creativecommons.org/licenses/by-sa/3.0/deed.en_US"><img alt="Creative Commons License" style="border-width:0" src="{{SITEURL}}/theme/img/cc-license.png" /></a>
            <span class="hidden">
                <!-- for search engines / screen scrapers -->
                <span xmlns:dct="http://purl.org/dc/terms/" property="dct:title">LinuxLefty.com content</span> by <a xmlns:cc="http://creativecommons.org/ns#" href="http://www.linuxlefty.com" property="cc:attributionName" rel="cc:attributionURL">Peter Naudus</a> is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/deed.en_US">Creative Commons Attribution-ShareAlike 3.0 Unported License</a>.
            </span>
        </footer>
    </div>

    <script src="{{ SITEURL }}/theme/js/jquery-1.7.2.min.js" type="text/javascript"></script>
    <script src="{{ SITEURL }}/theme/js/jquery.masonry.min.js" type="text/javascript"></script>
    <script src="{{ SITEURL }}/theme/js/jquery.infinitescroll.min.js" type="text/javascript"></script>
    <script type="text/javascript">

        $(document).ready(function() {
            $(".defaultText").focus(function(src) {
                if ($(this).val() == $(this)[0].title) {
                    $(this).removeClass("no-data");
                    $(this).val("");
                }
            }).blur(function() {
                if ($(this).val() == "") {
                    $(this).addClass("no-data");
                    $(this).val($(this)[0].title);
                }
            }).addClass("no-data");
            
            $(".defaultText").blur();        
        });

        $('section.boxes').imagesLoaded( function() {
            $('section.boxes').masonry({
                itemSelector: '.box',
                gutterWidth: 10,
                isResizable: true,
                isAnimated: true,
                animationOptions: {
                    duration: 'fast',
                    easing: 'linear',
                    queue: false
                },
                isFitWidth: true
            });
            resizeCodeBlocks();
        });

        $('section.boxes').infinitescroll({
                loading: {
                    finishedMsg: '<em>Bummer, nothing else to read</em>',
                    img: '{{ SITEURL }}/theme/img/loading.gif',
                    msgText: 'Stand by, loading more LinuxLefty goodness...',
                    selector: '#scroll_msg'
                },
                itemSelector: 'section.boxes article.box',
                navSelector: 'nav.paginator',
                nextSelector: 'nav.paginator a[rel=next]'
            },
            function( newElements ) {
                var $newElems = $( newElements ).css({ opacity: 0 });
                $newElems.imagesLoaded(function(){
                    $newElems.animate({ opacity: 1 });
                    $('section.boxes').masonry( 'appended', $newElems, true ); 
                });
            }
        );

        function resizeCodeBlocks() {
            $('table .codehilite').width($('#content_wrapper').width());
            $(window).resize( resizeCodeBlocks );
        }

        $('.codehilite').prepend( '<div class="newWindow"><a onclick="javascript:viewCode(this)">View in new window</a></div>' );

        function viewCode(target) {
            win = window.open("", "codehilite", "scrollbars=yes");
            win.document.write('<html><head><style>.newWindow { display: none; }</style><body>' + $(target).parents('.codehilite').html() + '</body></html>');
        }

        $('header #logo img.first').attr('src', '{{ SITEURL }}/theme/img/logo' + (Math.floor(Math.random()*16)+1) + '.gif').delay('slow').imagesLoaded(function() {
            $('header #logo img.second').fadeOut('slow');
        });

        $('#page > header nav ul li a').mouseenter(function() {
                $(this).animate({
                    'border-bottom-width': '20px',
                    'border-top-width': '10px',
                    'bottom': '15px'
                });
        });

        $('#page > header nav ul li.active a').mouseleave(function() {
                $(this).animate({
                    'border-bottom-width': '10px',
                    'border-top-width': '20px',
                    'bottom': '5px'
                });
        });

        $('#page > header nav ul li.inactive a').mouseleave(function() {
                $(this).animate({
                    'border-bottom-width': '5px',
                    'border-top-width': '0px',
                    'bottom': '0px'
                });
        });

    </script>

</body>
</html>
